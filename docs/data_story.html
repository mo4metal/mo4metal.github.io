<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>mo4metal.github.io - Data Story</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">mo4metal.github.io</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html" rel="" target="">
 <span class="menu-text">About Me</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./data_story.html" rel="" target="" aria-current="page">
 <span class="menu-text">Data Story</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#nbcs-community-data-analysis" id="toc-nbcs-community-data-analysis" class="nav-link active" data-scroll-target="#nbcs-community-data-analysis">NBC’s “Community” Data Analysis</a>
  <ul class="collapse">
  <li><a href="#episode-summaries" id="toc-episode-summaries" class="nav-link" data-scroll-target="#episode-summaries">Episode Summaries</a></li>
  <li><a href="#imdb-ratings-for-community-episodes-all-seasons" id="toc-imdb-ratings-for-community-episodes-all-seasons" class="nav-link" data-scroll-target="#imdb-ratings-for-community-episodes-all-seasons">IMDb Ratings for Community episodes (all seasons)</a></li>
  <li><a href="#imdb-ratings-per-season" id="toc-imdb-ratings-per-season" class="nav-link" data-scroll-target="#imdb-ratings-per-season">IMDB Ratings Per Season</a></li>
  <li><a href="#mean-imdb-ratings-per-season" id="toc-mean-imdb-ratings-per-season" class="nav-link" data-scroll-target="#mean-imdb-ratings-per-season">Mean IMDB Ratings per Season</a></li>
  <li><a href="#imdb-ratings-against-viewership" id="toc-imdb-ratings-against-viewership" class="nav-link" data-scroll-target="#imdb-ratings-against-viewership">IMDB Ratings Against Viewership</a></li>
  <li><a href="#viewership-trends-over-the-seasons" id="toc-viewership-trends-over-the-seasons" class="nav-link" data-scroll-target="#viewership-trends-over-the-seasons">Viewership Trends Over the Seasons</a></li>
  <li><a href="#viewership-trends-per-season" id="toc-viewership-trends-per-season" class="nav-link" data-scroll-target="#viewership-trends-per-season">Viewership Trends Per Season</a></li>
  <li><a href="#mean-imdb-rating-by-director" id="toc-mean-imdb-rating-by-director" class="nav-link" data-scroll-target="#mean-imdb-rating-by-director">Mean IMDB Rating by Director</a></li>
  <li><a href="#overall-thoughts" id="toc-overall-thoughts" class="nav-link" data-scroll-target="#overall-thoughts">Overall Thoughts</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Data Story</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="nbcs-community-data-analysis" class="level1">
<h1>NBC’s “Community” Data Analysis</h1>
<section id="episode-summaries" class="level2">
<h2 class="anchored" data-anchor-id="episode-summaries">Episode Summaries</h2>
<p>Select an episode to learn more about it!</p>
<iframe height="400" width="100%" frameborder="no" src="https://mo4metal.shinyapps.io/episode_search/"> </iframe>
<p>As can be viewed from the episode selection, Community uses the format of a university module name for the title of each episode. This can be argued to increase a feeling of relatability for viewers who have attended / are familiar with such modules. Such episodes also become more interesting and easily recognisable.</p>
</section>
<section id="imdb-ratings-for-community-episodes-all-seasons" class="level2">
<h2 class="anchored" data-anchor-id="imdb-ratings-for-community-episodes-all-seasons">IMDb Ratings for Community episodes (all seasons)</h2>
<div class="cell">
<div class="cell-output-display">
<p><img src="data_story_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This is a scatterplot showing the IMDB ratings of every season of the show Community. For a more detailed data analysis, it’s best to look closer at each season of Community, to see how its run did over the season.</p>
</section>
<section id="imdb-ratings-per-season" class="level2">
<h2 class="anchored" data-anchor-id="imdb-ratings-per-season">IMDB Ratings Per Season</h2>
<iframe height="400" width="100%" frameborder="no" src="https://mo4metal.shinyapps.io/imdb_rating_per_season/"> </iframe>
<p>There isn’t really a set trend for IMDB ratings per season. Interestingly, Community seems to ebb and flow with its IMDB ratings over each season, with a notable deviance from this in season 6. Episodes certainly do not “improve” in quality over seasons, and this could be attributed to the fact that Community was a sitcom. Given that sitcoms are episodic in nature, Community does not really ramp up consistently as compared to dramas such as Game of Thrones. Each episode of Community is distinct, and while there are plot lines running through episodes, such as the evolution of Troy and Abed’s friendship throughout the show, each episode can be watched in a standalone manner. Hence, IMDB ratings would probably not have a generic trend across a season.</p>
<p>However, spikes in IMDB ratings are almost always attributed to Community’s themed episodes. For example, the highest rated episode in Season 3 would be Episode 4, Remedial Chaos Theory, with a rating of 9.8. This episode is one of Community’s most popular episodes within its fanbase. Remedial Chaos Theory does not involve anything to do with the community college that the characters go to, rather, it takes place solely within Troy and Abed’s apartment, with the episode revolving around multiple alternate universes and each universe’s possible outcomes. Such an episode would be totally out of the ordinary for most sitcoms, but these themed episodes almost always do well with fans. It seems then, that there is a great demand for such special episodes.</p>
<p>A notable outlier to this claim would be Season 6. I will talk more about Season 6’s (lack of) popularity a little later, but it seems that there is a clear upward trend in IMDB ratings. I argue that this is because as the show ended in its sixth season, they wanted to end on a better note, and go out with a finale that really conveyed to its audience what Community was about. Season 6 starts a bit more pessimistically because of it needing to introduce newer characters that fans were unfamiliar with, and this detracted from the ratings. The IMDB ratings peaked at 9.5, with the show’s finale episode. This rating could be due to a sense of nostalgia, sure, but many fans consider the finale to be <a href="https://ew.com/article/2015/06/03/community-finale-season-6-ending/">almost perfect</a>.</p>
</section>
<section id="mean-imdb-ratings-per-season" class="level2">
<h2 class="anchored" data-anchor-id="mean-imdb-ratings-per-season">Mean IMDB Ratings per Season</h2>
<div class="cell">
<div class="cell-output-display">
<p><img src="data_story_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From this bar chart, we can see that Community has had a fairly successful run so far. The IMDB ratings of each season is fairly consistent, ranging from 7.4 to 8.6. Seasons 2 and 3 have the highest mean IMDB ratings, and this could be attributed to the notion that Community had finally found its footing after its first season. Seasons 2 and 3 also have many special episodes, such as episode 6 of season 2, “Epidemiology”, which has an IMDB rating of 9.3. This particular episode was a parody of a zombie movie, and it was also the season’s Halloween episode. Hence, such special episodes can be attributed to the seasons’ higher IMDB ratings.</p>
<p>Notably, Season 4 has the lowest mean IMDB rating, at 7.4. This can be attributed to the fact that show runner Dan Harmon was let go from the show after Season 3. This season is often called the <a href="https://screenrant.com/community-season-4-gas-leak-year-explained/">“Gas Leak Season”</a>, and it features what fans consider to be writing that was not on par with the rest of the show. The loss of the person who arguably best understood the show thus lead to a drop in quality. After season 4 ended, Dan Harmon was brought back for Season 5, which explains the higher mean IMDB rating, 8.4.</p>
<p>Finally, the last season also has a lower mean IMDB rating. This could be due to the fact that by this season, many once beloved characters such as Troy (Donald Glover) and Shirley (Yvette Nicole Brown) had left the show. Hence, such departures from the show impacted the fan base’s perceptions of the episodes in Season 6, leading to a lower mean IMDB score.</p>
</section>
<section id="imdb-ratings-against-viewership" class="level2">
<h2 class="anchored" data-anchor-id="imdb-ratings-against-viewership">IMDB Ratings Against Viewership</h2>
<iframe height="400" width="100%" frameborder="no" src="https://mo4metal.shinyapps.io/imdb_viewership/"> </iframe>
<p>Interestingly, there does not seem to be a positive relationship between IMDB ratings and Viewership numbers. This means that popular episodes and fan-favourite episodes are not correlated.</p>
<p>Notably, episodes that are higher viewed tend to do worse in terms of IMDB ratings. This is consistent throughout the seasons, with one of the worst offenders being the Pilot episode of Community, Season 1 Episode 1, with a viewership of almost 8 million and a lowly IMDB score of 7.7.</p>
<p>On contrast, episodes with lower viewership sometimes do better in terms of IMDB rating. A notable example of this would be Season 2, episode 23, with a viewership of around 3.5 million and a nearly perfect IMDB ranking of 9.7. Alongside this is Season 2, episode 24, with a lower viewership of 3.3 million and an IMDB ranking of 9.6. I brought these 2 episodes up specifically because they were aired as a 2 part special finale, directed by the Russo Brothers.</p>
<p>The aforementioned episodes parodied multiple genres and popular movies: Episode 23 parodied a Western, cowboy aesthetic, while Episode 24 parodied Star Wars. The plot of these episodes centers around a paintball match played on the college campus, with the winner receiving a huge cash prize. The unrealistic set-up would have already alienated viewers, who were not used to having a sitcom take an unexpected and strange turn into an action series. Furthermore, the parodies done would only have worked if an audience was already familiar with the shows being parodied in the first place, which set Community apart from the mainstream audience.</p>
<p>However, these episodes stand as some of Community’s best episodes specifically for these reasons: many praised Community’s inventiveness, and its ability to play with genre and pay homage to the many popular pieces of media that had come before it. Hence, I believe that this shows that it does not mean that if an episode was popular with a mainstream audience (evidenced by views), it would be a good, quality, or fan-favourite episode. The niche-ness of certain Community episodes really targeted a select audience, thus creating cult-classic episodes.</p>
</section>
<section id="viewership-trends-over-the-seasons" class="level2">
<h2 class="anchored" data-anchor-id="viewership-trends-over-the-seasons">Viewership Trends Over the Seasons</h2>
<div class="cell">
<div class="cell-output-display">
<p><img src="data_story_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Viewership truly faltered, slowing down over the seasons. This could be attributed to the fact that Community often did parody and special episodes, which require a prior knowledge of what was being parodied. Such episodes increased over the run of the show, solidfying Community’s standing as a show that was meant for people who were huge sitcom buffs, but this unfortunately alienated casual viewers.</p>
<p>Unfortunately, because Community was acquired by the now defunct streaming website, Yahoo! Screen, it was not aired on network television. Hence, there is no details on the number of viewers that Community had in its sixth season.</p>
<p>Ultimately, Community’s declining trend in viewership could mean that the unique episodes of Community did badly with a wider audience. This could substantiate the idea that many viewers preferred a more causal, relaxed viewing, and did not want to follow the show’s intricate and detailed parodies and plots.</p>
<p>However, this reduction of viewers could solidify the show’s cult classic status. Community still has a very dedicated fan base despite it being a decade after the show’s last season. Perhaps a lower viewership could create a sense of uniqueness amongst viewers, as they could view having watched Community to be a niche interest. Greater bonds between viewers could be formed this way.</p>
</section>
<section id="viewership-trends-per-season" class="level2">
<h2 class="anchored" data-anchor-id="viewership-trends-per-season">Viewership Trends Per Season</h2>
<iframe height="400" width="100%" frameborder="no" src="https://mo4metal.shinyapps.io/viewership_per_season/"> </iframe>
<p>Viewership can be seen as faltering throughout all seasons, with a steady downward trend throughout the season. This could be argued to be linked to the fact that Community did not do well on mainstream television, and thus lost viewership over time as plot lines wihtin seasons became more complicated.</p>
<p>However, there are some notable outliers to this trend. Season 3, episode</p>
<p>As mentioned before, due to Community being acquired by Yahoo, there is no viewership data for Season Six. This is quite a shame, as the data from Community’s sixth season could allow us to understand if the move from mainstream television to a streaming website would have affected viewership. I argue that this shift would have drastically reduced viewership numbers, especially since the sixth season was hosted on a relatively unknown and now defunct service.</p>
</section>
<section id="mean-imdb-rating-by-director" class="level2">
<h2 class="anchored" data-anchor-id="mean-imdb-rating-by-director">Mean IMDB Rating by Director</h2>
<div class="cell">
<div class="cell-output-display">
<p><img src="data_story_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In this graph, the numbers beside each bar represent the number of episodes that the director had directed.</p>
<p>Jeff Melman holds the highest mean IMDB rating, having directed Remedial Chaos Theory, as mentioned earlier. There are some notable inclusions in this chart. Firstly, Richard Ayoade, who acted in IT Club, a British sitcom, directed Critical Film Studies, Episode 19 of Season 2, which heavily referenced not only cult classic Pulp Fiction, but another movie, My Dinner with Andre. I posit that Ayoade’s familiarity with the sitcom genre, as well as having acted in a cult classic sitcom that allowed for him to direct such a critically acclaimed episode.</p>
<p>The Russo brothers are also featured on this list. Having made their start directing sitcoms such as Arrested Development, the Russo Brothers helped direct a whopping 33 episodes total on Community. Particularly, Joe Russo directed the aforementioned two-part paintball episodes, which were highly rated. These episodes inspired and <a href="https://www.denofgeek.com/tv/russo-brothers-community-prepared-us-for-marvel/">prepped</a> the Russo brothers to direct huge hits in the Marvel Cinematic universe.</p>
</section>
<section id="overall-thoughts" class="level2">
<h2 class="anchored" data-anchor-id="overall-thoughts">Overall Thoughts</h2>
<p>In an era of television where most shows are now produced and funded by streaming services, there seems to be a shift towards catering towards the widest audience possible in order to make the most revenue. Streaming services also seem to prefer having shorter, more succinct series-es, with the new Percy Jackson series having only 8 episodes, for example.</p>
<p>Community stands in contrast to everything that is “popular” in mainstream media. However, to answer the main question I posed at the start of this data analysis, “What can we learn from the run of the tv show Community”, I believe that this data story proves that a popular show does not necessarily mean that it is a quality show. Community, despite its falling viewership over the years, held onto its small, but dedicated fanbase by being unapologetically itself. Community’s various special episodes, ranging from paintball wars, remakes of zombie movies, spoofs of mafia movies, aren’t popular or necessarily interesting to a wider audience. However, these episodes consistently do well and are almost always highly rated on IMDB.</p>
<p>Notable is the fact that these special episodes aren’t many – they come only a few times every season, and this, I posit, is because Community had a longer run of episodes than a general sitcom now, with around 20 episodes or more per season. By allowing for more experimental episodes that contrasted heavily against the more mundane, but important, surrounding episodes, this allowed for Community to fully flesh out characters and endear them to audiences, while keeping audiences guessing what would happen next. It’s clear what we can learn from Community’s run then – that sitcoms of this generation need to learn from Community, and be more bold.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>